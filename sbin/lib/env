# -*- mode:shell-script -*-
export HTTPD_USER
HTTPD_USER=$(logname)

########################
# Executables
if [[ -x /opt/local/sbin/httpd ]]; then
    HTTPD="/opt/local/sbin/httpd"
else
    HTTPD=httpd
fi

if [[ -x "/opt/local/sbin/apachectl" ]]; then
    APACHECTL="/opt/local/sbin/apachectl"
else
    APACHECTL=apachectl
fi

if [[ -x "/opt/local/sbin/dnsmasq" ]]; then
    DNSMASQ="/opt/local/sbin/dnsmasq"
else
    DNSMASQ=dnsmasq
fi

export HTTPD
export APACHECTL
export DNSMASQ
export eval exe=("${APACHECTL} ${DNSMASQ}")



# pass through variables
export HTTP_SERVER_ROOT="/opt/local"
export HTTPD_ROOT; HTTPD_ROOT=$(pwd)

# Apache says it NOT include trailing slash
export HTTPD_DOCUMENT_ROOT="${HTTPD_ROOT}/www"
export PHP_ROOT="${HTTPD_ROOT}/etc/php72/"
export DNSMASQ_PID="${HTTPD_ROOT}/var/run/dnsmasq.pid"
export HTTPD_PID="${HTTPD_ROOT}/var/run/httpd.pid"
:
export DNS_RESOLV="${HTTPD_ROOT}/etc/resolv.conf"
export DNS_HOSTS="${HTTPD_ROOT}/etc/hosts"

export HTTPD_SERVER_NAME="localhost"

# Configs
export HTTPD_CONFIG="${HTTPD_ROOT}/conf/httpd.conf"
export DNSMASQ_CONFIG="${HTTPD_ROOT}/etc/dnsmasq.conf"


export HTTPD_VHOST_CUSTOM_LOG=/dev/null
export HTTPD_VHOST_ERROR_LOG=/dev/null


export DNSMASQ_LOG_PORT=9005
:
export HTTPD_LOG_PORT=9000

#export DNS_PORT=53


declare -A D
D[proc]='dnsmasq'
D[port]="${DNS_PORT}"
D[pid]="${DNSMASQ_PID}"

declare -A H
export H
H[proc]='httpd'
H[port]="${HTTPD_PORT}"
H[pid]="${HTTPD_PID}"

# unncessary
#PHP_CONFIG="${PHP_ROOT}/php-dev.ini"


  # The install paths have been changed to no longer violate the MacPorts mtree:

  #   1. The binaries are now under /opt/local/sbin/
  #      (rather than under /opt/local/apache2/bin/)

  #   2. The configure files are now under /opt/local/etc/apache2/
  #      (rather than under /opt/local/apache2/conf/)

  #   3. The modules are now under /opt/local/lib/apache2/modules/
  #      (rather than under /opt/local/apache2/modules/)

  #   4. The web root is now located under /opt/local/www/apache2/html/
  #      (rather than under /opt/local/apache2/htdocs/)

  #   5. The cgi-bin is now located under /opt/local/www/apache2/cgi-bin/
  #      (rather than under /opt/local/apache2/cgi-bin/)

  #   6. The logs are now located under /opt/local/var/log/apache2/
  #      (rather than under /opt/local/apache2/logs/)

  #   7. The manual is now located under /opt/local/www/apache2/manual/
  #      (rather than under /opt/local/apache2/manual/)

  #   8. The manual (man) pages are still at /opt/local/share/apache2/man/

  #   You can move your htdocs and cgi-bin to the new locations, or edit /opt/local/etc/apache2/httpd.conf to point at the old locations.
